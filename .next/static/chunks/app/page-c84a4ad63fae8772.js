(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3945:function(e,t,r){Promise.resolve().then(r.bind(r,6738))},6738:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ea}});var a,n,s,i,l=r(7437),o=r(2265);let d={"2026-01-01":{name:"元旦"},"2026-02-21":{name:"春节"},"2026-02-22":{name:"春节"},"2026-02-23":{name:"春节"},"2026-02-24":{name:"春节"},"2026-02-25":{name:"春节"},"2026-02-26":{name:"春节"},"2026-02-27":{name:"春节"},"2026-04-04":{name:"清明节"},"2026-04-05":{name:"清明节"},"2026-04-06":{name:"清明节"},"2026-05-01":{name:"劳动节"},"2026-05-02":{name:"劳动节"},"2026-05-03":{name:"劳动节"},"2026-05-04":{name:"劳动节"},"2026-05-05":{name:"劳动节"},"2026-06-20":{name:"端午节"},"2026-06-21":{name:"端午节"},"2026-06-22":{name:"端午节"},"2026-09-26":{name:"中秋节"},"2026-09-27":{name:"中秋节"},"2026-09-28":{name:"中秋节"},"2026-10-01":{name:"国庆节"},"2026-10-02":{name:"国庆节"},"2026-10-03":{name:"国庆节"},"2026-10-04":{name:"国庆节"},"2026-10-05":{name:"国庆节"},"2026-10-06":{name:"国庆节"},"2026-10-07":{name:"国庆节"},"2026-02-15":{name:"春节调休",isWorkDay:!0},"2026-02-28":{name:"春节调休",isWorkDay:!0},"2026-04-09":{name:"清明节调休",isWorkDay:!0},"2026-04-30":{name:"劳动节调休",isWorkDay:!0},"2026-06-23":{name:"端午节调休",isWorkDay:!0},"2026-09-29":{name:"中秋节调休",isWorkDay:!0},"2026-10-10":{name:"国庆节调休",isWorkDay:!0}},c=e=>d[e.toISOString().split("T")[0]]||null,m=e=>{let t=c(e);return!!t&&!t.isWorkDay},x=e=>{let t=c(e);return!!t&&!0===t.isWorkDay},h=e=>{if(m(e))return"text-red-600";if(x(e))return"text-gray-400";let t=e.getDay();return 0===t||6===t?"text-red-500":"text-gray-700"},g=e=>e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"}),u=(e,t)=>{let r=new Date(e,t,1),a=[];for(;r.getMonth()===t;)a.push(new Date(r)),r.setDate(r.getDate()+1);return a},p=e=>{let t=new Date(e);t.getDay(),t.getDate();let r=new Date(e);r.setDate(e.getDate()-e.getDay());let a=[];for(let e=0;e<7;e++){let t=new Date(r);t.setDate(r.getDate()+e),a.push(t)}return a},f=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate();(a=s||(s={})).WORK="WORK",a.PERSONAL="PERSONAL",a.URGENT="URGENT",a.OTHER="OTHER",(n=i||(i={})).LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH";let y=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),b=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),w=e=>{let t=b(e);return t.charAt(0).toUpperCase()+t.slice(1)},v=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},j=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var N={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let k=(0,o.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:i="",children:l,iconNode:d,...c}=e;return(0,o.createElement)("svg",{ref:t,...N,width:a,height:a,stroke:r,strokeWidth:s?24*Number(n)/Number(a):n,className:v("lucide",i),...!l&&!j(c)&&{"aria-hidden":"true"},...c},[...d.map(e=>{let[t,r]=e;return(0,o.createElement)(t,r)}),...Array.isArray(l)?l:[l]])}),D=(e,t)=>{let r=(0,o.forwardRef)((r,a)=>{let{className:n,...s}=r;return(0,o.createElement)(k,{ref:a,iconNode:t,className:v("lucide-".concat(y(w(e))),"lucide-".concat(e),n),...s})});return r.displayName=w(e),r},C=D("chevrons-up",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]),M=D("chevrons-down",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]),E=D("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),S=D("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),R=D("bell-off",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]]),O=D("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),z=D("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),A={[s.WORK]:"bg-blue-100 text-blue-800 border-blue-200",[s.PERSONAL]:"bg-green-100 text-green-800 border-green-200",[s.URGENT]:"bg-red-100 text-red-800 border-red-200",[s.OTHER]:"bg-gray-100 text-gray-800 border-gray-200"},T={[s.WORK]:"工作",[s.PERSONAL]:"个人",[s.URGENT]:"紧急",[s.OTHER]:"其他"},L={[s.WORK]:"\uD83D\uDCBC",[s.PERSONAL]:"\uD83D\uDC64",[s.URGENT]:"⚠️",[s.OTHER]:"\uD83D\uDCCC"},H=e=>0===e?"事件开始时":e<60?"提前 ".concat(e," 分钟"):60===e?"提前 1 小时":e%60==0?"提前 ".concat(e/60," 小时"):"提前 ".concat(e," 分钟"),I=e=>{let{priority:t}=e;switch(t){case i.HIGH:return(0,l.jsx)("span",{title:"高优先级",className:"flex items-center",children:(0,l.jsx)(C,{className:"w-3.5 h-3.5 text-red-600"})});case i.LOW:return(0,l.jsx)("span",{title:"低优先级",className:"flex items-center",children:(0,l.jsx)(M,{className:"w-3.5 h-3.5 text-blue-400"})});default:return null}},W=e=>{let{event:t,onClick:r,onToggleComplete:a,onToggleReminder:n,compact:i,style:o,className:d,timeFormat:c}=e,m=new Date(t.start),x=new Date(t.end),h=x<new Date;return(0,l.jsxs)("div",{onClick:e=>{e.stopPropagation(),r(t)},style:o,className:"\n        cursor-pointer rounded-md border p-2 mb-1 transition-all hover:shadow-md relative group\n        ".concat(A[t.type],"\n        ").concat(h||t.isCompleted?"opacity-60 grayscale":"opacity-100","\n        ").concat(i?"text-xs py-1 px-1.5 truncate":"text-sm","\n        ").concat(d||"","\n      "),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[a&&(0,l.jsx)("div",{role:"button",onClick:e=>{e.stopPropagation(),null==a||a(t.id)},className:"flex-shrink-0 text-current opacity-70 hover:opacity-100 hover:scale-110 transition-all",children:t.isCompleted?(0,l.jsx)(E,{className:"w-3.5 h-3.5"}):(0,l.jsx)("div",{className:"w-3.5 h-3.5 rounded-full border-[1.5px] border-current"})}),(0,l.jsx)(I,{priority:t.priority}),(0,l.jsxs)("span",{className:"font-semibold truncate ".concat(t.isCompleted?"line-through decoration-current":""),children:[("start"===c||"range"===c)&&(0,l.jsx)("span",{className:"font-normal opacity-80 mr-1",children:g(m)}),(0,l.jsx)("span",{className:"font-normal mr-1",children:i?L[t.type]:T[t.type]}),t.title]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[n&&(0,l.jsx)("div",{role:"button",onClick:e=>{e.stopPropagation(),null==n||n(t.id)},className:"transition-opacity ".concat(t.reminderEnabled?"opacity-100":"opacity-30 hover:opacity-100"),title:t.reminderEnabled?"提醒: ".concat(H(t.reminderMinutes)):"提醒已关闭",children:t.reminderEnabled?(0,l.jsx)(S,{className:"w-3 h-3 fill-current"}):(0,l.jsx)(R,{className:"w-3 h-3"})}),t.type===s.URGENT&&(0,l.jsx)(O,{className:"w-3 h-3 text-red-600"})]})]}),!i&&(0,l.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs opacity-80",children:[(0,l.jsx)(z,{className:"w-3 h-3"}),(0,l.jsxs)("span",{children:[g(m)," - ",g(x)]})]}),t.description&&!i&&(0,l.jsx)("p",{className:"mt-1 text-xs truncate opacity-70",children:t.description})]})},U=D("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),P=D("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),G=Array.from({length:24},(e,t)=>t),Z=e=>{var t;let{currentDate:r,viewMode:a,events:n,onMonthChange:s,onViewModeChange:i,onEventClick:d,onToggleComplete:m,onToggleReminder:x}=e,g=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(("week"===a||"day"===a)&&g.current){let e=new Date().getHours();g.current.scrollTop=Math.max(0,(e-1)*60)}},[a]);let y=(0,o.useMemo)(()=>{let e=u(r.getFullYear(),r.getMonth());return[...Array(e[0].getDay()).fill(null),...e]},[r]),b=r.toLocaleDateString("zh-CN",{month:"long",year:"numeric",timeZone:"Asia/Shanghai"}),w=new Date,v=e=>n.filter(t=>f(new Date(t.start),e)).map(e=>{let t=new Date(e.start),r=new Date(e.end),a=60*t.getHours()+t.getMinutes(),n=(r.getTime()-t.getTime())/6e4;return(0,l.jsx)(W,{event:e,onClick:d,onToggleComplete:m,onToggleReminder:x,compact:!0,timeFormat:"range",style:{top:"".concat(1*a,"px"),height:"".concat(Math.max(1*n,24),"px"),position:"absolute"},className:"left-1 right-1 z-10 shadow-sm text-xs overflow-hidden absolute"},e.id)});return(0,l.jsxs)("div",{className:"flex flex-col h-full bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-3 md:p-4 border-b border-gray-200 bg-white flex-none z-10 gap-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between md:justify-start gap-2 md:gap-4",children:[(0,l.jsx)("h2",{className:"text-lg md:text-2xl font-bold text-gray-800 truncate",children:"day"===a?"日程详情":b}),(0,l.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1 gap-1 flex-shrink-0",children:[(0,l.jsx)("button",{onClick:()=>i("month"),className:"px-2 md:px-3 py-1 text-xs md:text-sm rounded-md transition-all ".concat("month"===a?"bg-white text-indigo-600 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"),children:"月"}),(0,l.jsx)("button",{onClick:()=>i("week"),className:"px-2 md:px-3 py-1 text-xs md:text-sm rounded-md transition-all ".concat("week"===a?"bg-white text-indigo-600 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"),children:"周"}),(0,l.jsx)("button",{onClick:()=>i("day"),className:"px-2 md:px-3 py-1 text-xs md:text-sm rounded-md transition-all ".concat("day"===a?"bg-white text-indigo-600 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"),children:"日"})]})]}),(0,l.jsx)("div",{className:"flex justify-between md:justify-end gap-2",children:(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)("button",{onClick:()=>{let e=new Date(r);"month"===a?e.setMonth(e.getMonth()-1):"week"===a?e.setDate(e.getDate()-7):e.setDate(e.getDate()-1),s(e)},className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-full transition-colors border border-gray-200",children:(0,l.jsx)(U,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-600"})}),(0,l.jsx)("button",{onClick:()=>s(new Date),className:"px-3 py-1 text-xs md:text-sm font-medium text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-md transition-colors border border-indigo-100",children:"今天"}),(0,l.jsx)("button",{onClick:()=>{let e=new Date(r);"month"===a?e.setMonth(e.getMonth()+1):"week"===a?e.setDate(e.getDate()+7):e.setDate(e.getDate()+1),s(e)},className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-full transition-colors border border-gray-200",children:(0,l.jsx)(P,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-600"})})]})})]}),"month"===a&&(0,l.jsxs)("div",{className:"flex flex-col flex-1 h-full overflow-hidden",children:[(0,l.jsx)("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50 flex-none",children:["周日","周一","周二","周三","周四","周五","周六"].map(e=>(0,l.jsx)("div",{className:"py-2 md:py-3 text-center text-xs md:text-sm font-semibold text-gray-500 uppercase tracking-wider",children:e},e))}),(0,l.jsx)("div",{className:"grid grid-cols-7 flex-1 auto-rows-fr overflow-y-auto bg-white",children:y.map((e,t)=>{var r;if(!e)return(0,l.jsx)("div",{className:"bg-gray-50/30 border-b border-r border-gray-100 min-h-[80px]"},"empty-".concat(t));let a=n.filter(t=>f(new Date(t.start),e)),s=f(e,w);return(0,l.jsxs)("div",{className:"min-h-[80px] p-1 md:p-2 border-b border-r border-gray-100 hover:bg-gray-50 flex flex-col gap-1 overflow-hidden relative transition-colors",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,l.jsx)("div",{className:"text-xs md:text-sm font-medium w-6 h-6 md:w-7 md:h-7 flex items-center justify-center rounded-full ".concat(s?"bg-indigo-600 text-white":h(e)),children:e.getDate()}),c(e)&&(0,l.jsx)("div",{className:"text-[10px] md:text-xs truncate text-red-600 font-medium",children:null===(r=c(e))||void 0===r?void 0:r.name})]}),(0,l.jsx)("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-1",children:a.map(e=>(0,l.jsx)(W,{event:e,onClick:d,onToggleComplete:m,onToggleReminder:x,compact:!0,timeFormat:"start"},e.id))})]},e.toISOString())})})]}),"week"===a&&(()=>{let e=p(r);return(0,l.jsx)("div",{className:"flex-1 overflow-auto bg-white relative",ref:g,children:(0,l.jsxs)("div",{className:"min-w-[600px] md:min-w-0",children:[" ",(0,l.jsxs)("div",{className:"grid grid-cols-8 relative",children:[(0,l.jsx)("div",{className:"sticky left-0 top-0 z-40 bg-gray-50 border-r border-b border-gray-200 h-[60px]"}),e.map(e=>{let t=f(e,w),r=c(e);return(0,l.jsxs)("div",{className:"sticky top-0 z-30 bg-gray-50 border-b border-r border-gray-100 py-2 md:py-3 text-center h-[60px] flex flex-col items-center justify-center",children:[(0,l.jsx)("span",{className:"text-xs uppercase font-semibold ".concat(t?"text-indigo-600":h(e)),children:e.toLocaleDateString("zh-CN",{weekday:"short",timeZone:"Asia/Shanghai"})}),(0,l.jsx)("span",{className:"mt-1 w-6 h-6 md:w-8 md:h-8 flex items-center justify-center rounded-full text-sm md:text-lg font-medium ".concat(t?"bg-indigo-600 text-white":h(e)),children:e.getDate()}),r&&(0,l.jsx)("span",{className:"text-[9px] md:text-xs truncate text-red-600 font-medium mt-0.5",children:r.name})]},"header-".concat(e))}),(0,l.jsx)("div",{className:"sticky left-0 z-20 bg-white border-r border-gray-200",children:G.map(e=>(0,l.jsx)("div",{style:{height:60},className:"text-xs text-gray-400 text-right pr-2 pt-1 border-b border-transparent relative",children:(0,l.jsxs)("span",{className:"-top-3 relative",children:[e,":00"]})},"time-".concat(e)))}),e.map(e=>(0,l.jsxs)("div",{className:"border-r border-gray-100 relative bg-white",children:[f(e,w)&&(0,l.jsx)("div",{className:"absolute w-full border-t-2 border-red-500 z-20 pointer-events-none flex items-center",style:{top:"".concat((60*w.getHours()+w.getMinutes())*1,"px")},children:(0,l.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full -ml-1"})}),G.map(t=>(0,l.jsx)("div",{style:{height:60},className:"border-b border-gray-100"},"cell-".concat(e,"-").concat(t))),v(e)]},"col-".concat(e)))]})]})})})(),"day"===a&&(0,l.jsx)("div",{className:"flex-1 overflow-auto bg-white relative",ref:g,children:(0,l.jsxs)("div",{className:"flex min-h-[800px]",children:[" ",(0,l.jsx)("div",{className:"w-16 md:w-20 flex-none border-r border-gray-200 bg-white sticky left-0 z-20",children:G.map(e=>(0,l.jsx)("div",{style:{height:60},className:"text-xs text-gray-400 text-right pr-2 md:pr-4 pt-1 border-b border-transparent relative",children:(0,l.jsxs)("span",{className:"-top-3 relative",children:[e,":00"]})},e))}),(0,l.jsxs)("div",{className:"flex-1 relative bg-white",children:[(0,l.jsx)("div",{className:"sticky top-0 z-30 bg-gray-50 border-b border-gray-200 p-2 text-center",children:(0,l.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,l.jsx)("span",{className:"text-base md:text-lg font-semibold ".concat(f(r,w)?"text-indigo-600":h(r)),children:r.toLocaleDateString("zh-CN",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"Asia/Shanghai"})}),c(r)&&(0,l.jsx)("span",{className:"text-xs truncate text-red-600 font-medium",children:null===(t=c(r))||void 0===t?void 0:t.name})]})}),f(r,w)&&(0,l.jsxs)("div",{className:"absolute w-full border-t-2 border-red-500 z-20 pointer-events-none flex items-center",style:{top:"".concat((60*w.getHours()+w.getMinutes())*1,"px")},children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full -ml-1"}),(0,l.jsx)("span",{className:"text-xs text-red-500 bg-white px-1 ml-1 font-medium",children:w.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"})})]}),G.map(e=>(0,l.jsx)("div",{style:{height:60},className:"border-b border-gray-100"},e)),v(r)]})]})})]})},F=D("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),_=D("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),q=D("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),K=D("circle-stop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),B=D("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),J=D("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),V=e=>{let{isProcessing:t,onSendMessage:r,messages:a,onClose:n}=e,[s,i]=(0,o.useState)(""),[d,c]=(0,o.useState)(!1),m=(0,o.useRef)(null),x=(0,o.useRef)(null);(0,o.useEffect)(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){let e=window.SpeechRecognition||window.webkitSpeechRecognition;m.current=new e,m.current.continuous=!1,m.current.interimResults=!1,m.current.lang="zh-CN",m.current.onresult=e=>{let t=e.results[0][0].transcript;i(t),h(t)},m.current.onend=()=>{c(!1)},m.current.onerror=e=>{console.error("Speech recognition error",e.error),c(!1)}}},[]),(0,o.useEffect)(()=>{var e;null===(e=x.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[a]);let h=e=>{e.trim()&&(r(e),i(""))};return(0,l.jsxs)("div",{className:"flex flex-col h-full bg-white md:border-l border-gray-200 shadow-xl w-full",children:[(0,l.jsxs)("div",{className:"p-4 bg-indigo-600 text-white flex items-center justify-between shadow-sm flex-none",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(F,{className:"w-6 h-6"}),(0,l.jsx)("h2",{className:"font-semibold text-lg",children:"AI 助手"})]}),n&&(0,l.jsx)("button",{onClick:n,className:"md:hidden text-white/80 hover:text-white p-1",children:(0,l.jsx)(_,{className:"w-6 h-6"})})]}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[0===a.length&&(0,l.jsxs)("div",{className:"text-center text-gray-400 mt-10",children:[(0,l.jsx)("p",{className:"mb-2",children:"\uD83D\uDC4B 你好! 我是你的智能日程助手。"}),(0,l.jsxs)("p",{className:"text-sm",children:["试着说: ",(0,l.jsx)("br",{}),'"明天下午两点和团队开会"']})]}),a.map(e=>(0,l.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,l.jsx)("div",{className:"max-w-[85%] p-3 rounded-2xl text-sm ".concat("user"===e.role?"bg-indigo-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none shadow-sm"),children:e.content})},e.id)),t&&(0,l.jsx)("div",{className:"flex justify-start",children:(0,l.jsxs)("div",{className:"bg-white p-3 rounded-2xl rounded-bl-none border border-gray-200 shadow-sm flex items-center gap-2",children:[(0,l.jsx)(q,{className:"w-4 h-4 animate-spin text-indigo-600"}),(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"思考中..."})]})}),(0,l.jsx)("div",{ref:x})]}),(0,l.jsx)("div",{className:"p-4 bg-white border-t border-gray-200 flex-none pb-safe",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{onClick:()=>{var e,t;d?null===(e=m.current)||void 0===e||e.stop():(c(!0),null===(t=m.current)||void 0===t||t.start())},className:"p-3 rounded-full transition-colors flex-shrink-0 ".concat(d?"bg-red-100 text-red-600 animate-pulse":"bg-gray-100 text-gray-600 hover:bg-gray-200"),title:"语音输入 (中文)",children:d?(0,l.jsx)(K,{className:"w-5 h-5"}):(0,l.jsx)(B,{className:"w-5 h-5"})}),(0,l.jsx)("div",{className:"flex-1 relative",children:(0,l.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),onKeyDown:e=>"Enter"===e.key&&h(s),placeholder:"输入...",className:"w-full pl-4 pr-10 py-3 bg-gray-100 border-none rounded-full text-sm focus:ring-2 focus:ring-indigo-500 outline-none",disabled:t||d})}),(0,l.jsx)("button",{onClick:()=>h(s),disabled:!s.trim()||t,className:"p-3 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 disabled:opacity-50 transition-colors flex-shrink-0",children:(0,l.jsx)(J,{className:"w-5 h-5"})})]})})]})},Y="lifestream_events",$=e=>{try{localStorage.setItem(Y,JSON.stringify(e))}catch(e){console.error("Failed to save events",e)}},Q=()=>{try{{let e=localStorage.getItem(Y);return e?JSON.parse(e):[]}}catch(e){return console.error("Failed to load events",e),[]}},X=async(e,t,r)=>{try{let a=await fetch("/api/ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:e,currentEvents:t,viewDate:new Date(r.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})).toISOString()})});if(!a.ok)throw Error("Failed to fetch AI response");return await a.json()}catch(e){throw console.error("Error processing request:",e),e}},ee=D("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),et=D("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var er=()=>{let[e,t]=(0,o.useState)([]),[r,a]=(0,o.useState)(new Date),[n,s]=(0,o.useState)("month"),[d,c]=(0,o.useState)([]),[m,x]=(0,o.useState)(!1),[h,g]=(0,o.useState)(null),[u,p]=(0,o.useState)(!1);(0,o.useEffect)(()=>{t(Q().map(e=>({...e,reminderEnabled:void 0===e.reminderEnabled||e.reminderEnabled,reminderMinutes:void 0!==e.reminderMinutes?e.reminderMinutes:15,priority:void 0!==e.priority?e.priority:i.MEDIUM}))),"Notification"in window&&"granted"!==Notification.permission&&Notification.requestPermission()},[]),(0,o.useEffect)(()=>{$(e)},[e]),(0,o.useEffect)(()=>{let e=setInterval(()=>{let e=new Date;t(t=>t.map(t=>{if(!t.reminderEnabled||t.notified)return t;let r=new Date(t.start).getTime(),a=6e4*t.reminderMinutes,n=r-e.getTime();return n>0&&n<=a?("granted"===Notification.permission&&new Notification("日程提醒: ".concat(t.title),{body:"将在 ".concat(Math.round(n/6e4)," 分钟后开始。"),icon:"/favicon.ico"}),{...t,notified:!0}):t}))},1e4);return()=>clearInterval(e)},[]);let f=async a=>{let n={id:Date.now().toString(),role:"user",content:a,timestamp:Date.now()};c(e=>[...e,n]),x(!0);try{let{events:n,message:s}=await X(a,e,r),i=n.map(e=>({...e,id:crypto.randomUUID(),isCompleted:!1,notified:!1,reminderEnabled:!0,reminderMinutes:15}));i.length>0&&t(e=>[...e,...i]);let l={id:(Date.now()+1).toString(),role:"assistant",content:s,timestamp:Date.now()};c(e=>[...e,l])}catch(t){console.error(t);let e={id:(Date.now()+1).toString(),role:"assistant",content:"处理请求时出错，请检查网络或 API 配置。",timestamp:Date.now()};c(t=>[...t,e])}finally{x(!1)}},y=e=>{t(t=>t.filter(t=>t.id!==e)),g(null)},b=e=>{t(t=>t.map(t=>t.id===e?{...t,isCompleted:!t.isCompleted}:t)),h&&h.id===e&&g(e=>e?{...e,isCompleted:!e.isCompleted}:null)},w=e=>{t(t=>t.map(t=>t.id===e?{...t,reminderEnabled:!t.reminderEnabled}:t)),h&&h.id===e&&g(e=>e?{...e,reminderEnabled:!e.reminderEnabled}:null)},v=(e,r)=>{t(t=>t.map(t=>t.id===e?{...t,reminderMinutes:r,reminderEnabled:!0,notified:!1}:t)),h&&h.id===e&&g(e=>e?{...e,reminderMinutes:r,reminderEnabled:!0,notified:!1}:null)};return(0,l.jsxs)("div",{className:"relative h-screen w-full bg-gray-100 flex overflow-hidden",children:[(0,l.jsxs)("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative z-0",children:[(0,l.jsx)("header",{className:"px-4 py-3 md:p-4 bg-white border-b border-gray-200 flex justify-between items-center shadow-sm flex-none z-10",children:(0,l.jsx)("div",{children:(0,l.jsxs)("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,l.jsx)("span",{className:"bg-indigo-600 text-white px-2 py-0.5 rounded-lg text-lg",children:"LS"}),"LifeStream"]})})}),(0,l.jsx)("div",{className:"flex-1 overflow-hidden p-2 md:p-4",children:(0,l.jsx)(Z,{currentDate:r,viewMode:n,onViewModeChange:s,events:e,onMonthChange:a,onEventClick:g,onToggleComplete:b,onToggleReminder:w})}),(0,l.jsx)("button",{onClick:()=>p(!0),className:"md:hidden absolute bottom-6 right-6 w-14 h-14 bg-indigo-600 text-white rounded-full shadow-xl flex items-center justify-center hover:bg-indigo-700 transition-transform active:scale-95 z-30","aria-label":"Open AI Assistant",children:(0,l.jsx)(ee,{className:"w-7 h-7"})})]}),(0,l.jsx)("div",{className:"\n        fixed inset-0 z-40 bg-black/20 backdrop-blur-sm md:static md:bg-transparent md:backdrop-blur-none md:z-auto md:w-96 md:flex-none\n        transition-all duration-300\n        ".concat(u?"opacity-100 visible":"opacity-0 invisible md:opacity-100 md:visible","\n      "),onClick:()=>p(!1),children:(0,l.jsx)("div",{className:"\n            absolute bottom-0 left-0 right-0 h-[80vh] md:h-full md:relative bg-white shadow-2xl rounded-t-2xl md:rounded-none flex flex-col\n            transform transition-transform duration-300 ease-out\n            ".concat(u?"translate-y-0":"translate-y-full md:translate-y-0","\n          "),onClick:e=>e.stopPropagation(),children:(0,l.jsx)(V,{isProcessing:m,onSendMessage:f,messages:d,onClose:()=>p(!1)})})}),h&&(0,l.jsx)("div",{className:"absolute inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in duration-200",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative animate-in zoom-in-95 duration-200",children:[(0,l.jsx)("button",{onClick:()=>g(null),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 p-2",children:(0,l.jsx)(_,{className:"w-6 h-6"})}),(0,l.jsxs)("div",{className:"flex items-start gap-3 mb-2 pr-8",children:[(0,l.jsx)("button",{onClick:()=>b(h.id),className:"p-1 mt-1 rounded-full transition-colors flex-shrink-0 ".concat(h.isCompleted?"text-indigo-600 bg-indigo-50":"text-gray-300 hover:text-gray-500"),children:(0,l.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center ".concat(h.isCompleted?"border-indigo-600":"border-current"),children:h.isCompleted&&(0,l.jsx)("div",{className:"w-3 h-3 bg-indigo-600 rounded-full"})})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-bold leading-tight ".concat(h.isCompleted?"line-through text-gray-400":"text-gray-900"),children:h.title}),(0,l.jsxs)("div",{className:"flex gap-2 mt-2 flex-wrap",children:[(0,l.jsx)("span",{className:"inline-block px-2 py-0.5 bg-gray-100 rounded text-xs text-gray-600 font-medium",children:h.type}),(0,l.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ".concat(h.priority===i.HIGH?"bg-red-100 text-red-700":h.priority===i.LOW?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600"),children:[h.priority===i.HIGH&&(0,l.jsx)(C,{className:"w-3 h-3"}),h.priority===i.LOW&&(0,l.jsx)(M,{className:"w-3 h-3"}),h.priority===i.MEDIUM&&(0,l.jsx)(et,{className:"w-3 h-3"}),h.priority===i.HIGH?"高":h.priority===i.LOW?"低":"中"]})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4 mt-6",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-1 p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 uppercase font-semibold",children:[(0,l.jsx)(z,{className:"w-3 h-3"}),(0,l.jsx)("span",{children:"时间"})]}),(0,l.jsxs)("div",{className:"text-gray-800 text-sm",children:[new Date(h.start).toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"}),(0,l.jsx)("span",{className:"mx-2 text-gray-400",children:"至"}),new Date(h.end).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(S,{className:"w-4 h-4 ".concat(h.reminderEnabled?"text-indigo-600":"text-gray-400")}),(0,l.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"提醒"})]}),(0,l.jsx)("button",{onClick:()=>w(h.id),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 ".concat(h.reminderEnabled?"bg-indigo-600":"bg-gray-200"),children:(0,l.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform ".concat(h.reminderEnabled?"translate-x-6":"translate-x-1")})})]}),h.reminderEnabled&&(0,l.jsx)("div",{className:"mt-2 pl-6",children:(0,l.jsx)("select",{value:h.reminderMinutes,onChange:e=>v(h.id,Number(e.target.value)),className:"w-full bg-white border border-gray-200 text-gray-700 text-sm rounded-md p-2 focus:ring-2 focus:ring-indigo-500 outline-none",children:[{value:0,label:"事件开始时"},{value:5,label:"提前 5 分钟"},{value:15,label:"提前 15 分钟"},{value:30,label:"提前 30 分钟"},{value:60,label:"提前 1 小时"},{value:120,label:"提前 2 小时"},{value:1440,label:"提前 1 天"}].map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})})]}),h.description&&(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500 uppercase font-semibold",children:"详情"}),(0,l.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed bg-white border border-gray-100 p-3 rounded-lg max-h-32 overflow-y-auto",children:h.description})]}),(0,l.jsxs)("div",{className:"pt-4 flex justify-end gap-3 border-t border-gray-100 mt-2",children:[(0,l.jsx)("button",{onClick:()=>y(h.id),className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm font-medium",children:"删除"}),(0,l.jsx)("button",{onClick:()=>g(null),className:"px-4 py-2 bg-indigo-600 text-white hover:bg-indigo-700 rounded-lg transition-colors text-sm font-medium",children:"关闭"})]})]})]})})]})};function ea(){return(0,l.jsx)(er,{})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3945)}),_N_E=e.O()}]);