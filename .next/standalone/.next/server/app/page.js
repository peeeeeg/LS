(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6142:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>d}),r(5807),r(1506),r(5866);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),l=r(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5807)),"C:\\AIRL\\lifestream-智能日历 （CN）\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1506)),"C:\\AIRL\\lifestream-智能日历 （CN）\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\AIRL\\lifestream-智能日历 （CN）\\app\\page.tsx"],m="/page",x={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5663:(e,t,r)=>{Promise.resolve().then(r.bind(r,1646))},2029:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},1949:()=>{},1646:(e,t,r)=>{"use strict";r.d(t,{default:()=>F});var s,a,i=r(326),n=r(7577);let l=e=>e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"}),o=(e,t)=>{let r=new Date(e,t,1),s=[];for(;r.getMonth()===t;)s.push(new Date(r)),r.setDate(r.getDate()+1);return s},d=e=>{let t=new Date(e);t.getDay(),t.getDate();let r=new Date(e);r.setDate(e.getDate()-e.getDay());let s=[];for(let e=0;e<7;e++){let t=new Date(r);t.setDate(r.getDate()+e),s.push(t)}return s},c=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate();(function(e){e.WORK="WORK",e.PERSONAL="PERSONAL",e.URGENT="URGENT",e.OTHER="OTHER"})(s||(s={})),function(e){e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"}(a||(a={}));let m=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),x=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),h=e=>{let t=x(e);return t.charAt(0).toUpperCase()+t.slice(1)},g=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),p=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let b=(0,n.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:i,iconNode:l,...o},d)=>(0,n.createElement)("svg",{ref:d,...u,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:g("lucide",a),...!i&&!p(o)&&{"aria-hidden":"true"},...o},[...l.map(([e,t])=>(0,n.createElement)(e,t)),...Array.isArray(i)?i:[i]])),f=(e,t)=>{let r=(0,n.forwardRef)(({className:r,...s},a)=>(0,n.createElement)(b,{ref:a,iconNode:t,className:g(`lucide-${m(h(e))}`,`lucide-${e}`,r),...s}));return r.displayName=h(e),r},y=f("chevrons-up",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]),w=f("chevrons-down",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]),v=f("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),j=f("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),N=f("bell-off",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]]),k=f("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),C=f("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),D={[s.WORK]:"bg-blue-100 text-blue-800 border-blue-200",[s.PERSONAL]:"bg-green-100 text-green-800 border-green-200",[s.URGENT]:"bg-red-100 text-red-800 border-red-200",[s.OTHER]:"bg-gray-100 text-gray-800 border-gray-200"},M=e=>0===e?"事件开始时":e<60?`提前 ${e} 分钟`:60===e?"提前 1 小时":e%60==0?`提前 ${e/60} 小时`:`提前 ${e} 分钟`,S=({priority:e})=>{switch(e){case a.HIGH:return i.jsx("span",{title:"高优先级",className:"flex items-center",children:i.jsx(y,{className:"w-3.5 h-3.5 text-red-600"})});case a.LOW:return i.jsx("span",{title:"低优先级",className:"flex items-center",children:i.jsx(w,{className:"w-3.5 h-3.5 text-blue-400"})});default:return null}},E=({event:e,onClick:t,onToggleComplete:r,onToggleReminder:a,compact:n,style:o,className:d,timeFormat:c})=>{let m=new Date(e.start),x=new Date(e.end),h=x<new Date;return(0,i.jsxs)("div",{onClick:r=>{r.stopPropagation(),t(e)},style:o,className:`
        cursor-pointer rounded-md border p-2 mb-1 transition-all hover:shadow-md relative group
        ${D[e.type]}
        ${h||e.isCompleted?"opacity-60 grayscale":"opacity-100"}
        ${n?"text-xs py-1 px-1.5 truncate":"text-sm"}
        ${d||""}
      `,children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-1.5 min-w-0 flex-1",children:[r&&i.jsx("div",{role:"button",onClick:t=>{t.stopPropagation(),r?.(e.id)},className:"flex-shrink-0 text-current opacity-70 hover:opacity-100 hover:scale-110 transition-all",children:e.isCompleted?i.jsx(v,{className:"w-3.5 h-3.5"}):i.jsx("div",{className:"w-3.5 h-3.5 rounded-full border-[1.5px] border-current"})}),i.jsx(S,{priority:e.priority}),(0,i.jsxs)("span",{className:`font-semibold truncate ${e.isCompleted?"line-through decoration-current":""}`,children:[("start"===c||"range"===c)&&i.jsx("span",{className:"font-normal opacity-80 mr-1",children:l(m)}),e.title]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[a&&!n&&i.jsx("div",{role:"button",onClick:t=>{t.stopPropagation(),a?.(e.id)},className:`transition-opacity ${e.reminderEnabled?"opacity-100":"opacity-30 hover:opacity-100"}`,title:e.reminderEnabled?`提醒: ${M(e.reminderMinutes)}`:"提醒已关闭",children:e.reminderEnabled?i.jsx(j,{className:"w-3 h-3 fill-current"}):i.jsx(N,{className:"w-3 h-3"})}),e.type===s.URGENT&&!n&&i.jsx(k,{className:"w-3 h-3 text-red-600"})]})]}),!n&&(0,i.jsxs)("div",{className:"flex items-center gap-1 mt-1 text-xs opacity-80",children:[i.jsx(C,{className:"w-3 h-3"}),(0,i.jsxs)("span",{children:[l(m)," - ",l(x)]})]}),e.description&&!n&&i.jsx("p",{className:"mt-1 text-xs truncate opacity-70",children:e.description})]})},$=f("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),A=f("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),P=Array.from({length:24},(e,t)=>t),z=({currentDate:e,viewMode:t,events:r,onMonthChange:s,onViewModeChange:a,onEventClick:l,onToggleComplete:m,onToggleReminder:x})=>{let h=(0,n.useRef)(null);(0,n.useEffect)(()=>{if(("week"===t||"day"===t)&&h.current){let e=new Date().getHours();h.current.scrollTop=Math.max(0,(e-1)*60)}},[t]);let g=(0,n.useMemo)(()=>{let t=o(e.getFullYear(),e.getMonth());return[...Array(t[0].getDay()).fill(null),...t]},[e]),p=e.toLocaleDateString("zh-CN",{month:"long",year:"numeric",timeZone:"Asia/Shanghai"}),u=new Date,b=e=>r.filter(t=>c(new Date(t.start),e)).map(e=>{let t=new Date(e.start),r=new Date(e.end),s=60*t.getHours()+t.getMinutes(),a=(r.getTime()-t.getTime())/6e4;return i.jsx(E,{event:e,onClick:l,onToggleComplete:m,onToggleReminder:x,compact:!0,timeFormat:"range",style:{top:`${1*s}px`,height:`${Math.max(1*a,24)}px`,position:"absolute"},className:"left-1 right-1 z-10 shadow-sm text-xs overflow-hidden absolute"},e.id)});return(0,i.jsxs)("div",{className:"flex flex-col h-full bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-3 md:p-4 border-b border-gray-200 bg-white flex-none z-10 gap-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between md:justify-start gap-2 md:gap-4",children:[i.jsx("h2",{className:"text-lg md:text-2xl font-bold text-gray-800 truncate",children:"day"===t?"日程详情":p}),(0,i.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1 gap-1 flex-shrink-0",children:[i.jsx("button",{onClick:()=>a("month"),className:`px-2 md:px-3 py-1 text-xs md:text-sm rounded-md transition-all ${"month"===t?"bg-white text-indigo-600 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"}`,children:"月"}),i.jsx("button",{onClick:()=>a("week"),className:`px-2 md:px-3 py-1 text-xs md:text-sm rounded-md transition-all ${"week"===t?"bg-white text-indigo-600 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"}`,children:"周"}),i.jsx("button",{onClick:()=>a("day"),className:`px-2 md:px-3 py-1 text-xs md:text-sm rounded-md transition-all ${"day"===t?"bg-white text-indigo-600 shadow-sm font-medium":"text-gray-500 hover:text-gray-700"}`,children:"日"})]})]}),i.jsx("div",{className:"flex justify-between md:justify-end gap-2",children:(0,i.jsxs)("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>{let r=new Date(e);"month"===t?r.setMonth(r.getMonth()-1):"week"===t?r.setDate(r.getDate()-7):r.setDate(r.getDate()-1),s(r)},className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-full transition-colors border border-gray-200",children:i.jsx($,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-600"})}),i.jsx("button",{onClick:()=>s(new Date),className:"px-3 py-1 text-xs md:text-sm font-medium text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-md transition-colors border border-indigo-100",children:"今天"}),i.jsx("button",{onClick:()=>{let r=new Date(e);"month"===t?r.setMonth(r.getMonth()+1):"week"===t?r.setDate(r.getDate()+7):r.setDate(r.getDate()+1),s(r)},className:"p-1.5 md:p-2 hover:bg-gray-100 rounded-full transition-colors border border-gray-200",children:i.jsx(A,{className:"w-4 h-4 md:w-5 md:h-5 text-gray-600"})})]})})]}),"month"===t&&(0,i.jsxs)("div",{className:"flex flex-col flex-1 h-full overflow-hidden",children:[i.jsx("div",{className:"grid grid-cols-7 border-b border-gray-200 bg-gray-50 flex-none",children:["周日","周一","周二","周三","周四","周五","周六"].map(e=>i.jsx("div",{className:"py-2 md:py-3 text-center text-xs md:text-sm font-semibold text-gray-500 uppercase tracking-wider",children:e},e))}),i.jsx("div",{className:"grid grid-cols-7 flex-1 auto-rows-fr overflow-y-auto bg-white",children:g.map((e,t)=>{if(!e)return i.jsx("div",{className:"bg-gray-50/30 border-b border-r border-gray-100 min-h-[80px]"},`empty-${t}`);let s=r.filter(t=>c(new Date(t.start),e)),a=c(e,u);return(0,i.jsxs)("div",{className:"min-h-[80px] p-1 md:p-2 border-b border-r border-gray-100 hover:bg-gray-50 flex flex-col gap-1 overflow-hidden relative transition-colors",children:[i.jsx("div",{className:`text-xs md:text-sm font-medium w-6 h-6 md:w-7 md:h-7 flex items-center justify-center rounded-full mb-1 ${a?"bg-indigo-600 text-white":"text-gray-700"}`,children:e.getDate()}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-1",children:s.map(e=>i.jsx(E,{event:e,onClick:l,onToggleComplete:m,onToggleReminder:x,compact:!0,timeFormat:"start"},e.id))})]},e.toISOString())})})]}),"week"===t&&(()=>{let t=d(e);return i.jsx("div",{className:"flex-1 overflow-auto bg-white relative",ref:h,children:(0,i.jsxs)("div",{className:"min-w-[600px] md:min-w-0",children:[" ",(0,i.jsxs)("div",{className:"grid grid-cols-8 relative",children:[i.jsx("div",{className:"sticky left-0 top-0 z-40 bg-gray-50 border-r border-b border-gray-200 h-[60px]"}),t.map(e=>{let t=c(e,u);return(0,i.jsxs)("div",{className:"sticky top-0 z-30 bg-gray-50 border-b border-r border-gray-100 py-2 md:py-3 text-center h-[60px] flex flex-col items-center justify-center",children:[i.jsx("span",{className:`text-xs uppercase font-semibold ${t?"text-indigo-600":"text-gray-500"}`,children:e.toLocaleDateString("zh-CN",{weekday:"short",timeZone:"Asia/Shanghai"})}),i.jsx("span",{className:`mt-1 w-6 h-6 md:w-8 md:h-8 flex items-center justify-center rounded-full text-sm md:text-lg font-medium ${t?"bg-indigo-600 text-white":"text-gray-800"}`,children:e.getDate()})]},`header-${e}`)}),i.jsx("div",{className:"sticky left-0 z-20 bg-white border-r border-gray-200",children:P.map(e=>i.jsx("div",{style:{height:60},className:"text-xs text-gray-400 text-right pr-2 pt-1 border-b border-transparent relative",children:(0,i.jsxs)("span",{className:"-top-3 relative",children:[e,":00"]})},`time-${e}`))}),t.map(e=>(0,i.jsxs)("div",{className:"border-r border-gray-100 relative bg-white",children:[c(e,u)&&i.jsx("div",{className:"absolute w-full border-t-2 border-red-500 z-20 pointer-events-none flex items-center",style:{top:`${(60*u.getHours()+u.getMinutes())*1}px`},children:i.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full -ml-1"})}),P.map(t=>i.jsx("div",{style:{height:60},className:"border-b border-gray-100"},`cell-${e}-${t}`)),b(e)]},`col-${e}`))]})]})})})(),"day"===t&&i.jsx("div",{className:"flex-1 overflow-auto bg-white relative",ref:h,children:(0,i.jsxs)("div",{className:"flex min-h-[800px]",children:[" ",i.jsx("div",{className:"w-16 md:w-20 flex-none border-r border-gray-200 bg-white sticky left-0 z-20",children:P.map(e=>i.jsx("div",{style:{height:60},className:"text-xs text-gray-400 text-right pr-2 md:pr-4 pt-1 border-b border-transparent relative",children:(0,i.jsxs)("span",{className:"-top-3 relative",children:[e,":00"]})},e))}),(0,i.jsxs)("div",{className:"flex-1 relative bg-white",children:[i.jsx("div",{className:"sticky top-0 z-30 bg-gray-50 border-b border-gray-200 p-2 text-center",children:i.jsx("span",{className:`text-base md:text-lg font-semibold ${c(e,u)?"text-indigo-600":"text-gray-800"}`,children:e.toLocaleDateString("zh-CN",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"Asia/Shanghai"})})}),c(e,u)&&(0,i.jsxs)("div",{className:"absolute w-full border-t-2 border-red-500 z-20 pointer-events-none flex items-center",style:{top:`${(60*u.getHours()+u.getMinutes())*1}px`},children:[i.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full -ml-1"}),i.jsx("span",{className:"text-xs text-red-500 bg-white px-1 ml-1 font-medium",children:u.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"})})]}),P.map(e=>i.jsx("div",{style:{height:60},className:"border-b border-gray-100"},e)),b(e)]})]})})]})},L=f("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),R=f("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),I=f("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),T=f("circle-stop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),H=f("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),O=f("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),_=({isProcessing:e,onSendMessage:t,messages:r,onClose:s})=>{let[a,l]=(0,n.useState)(""),[o,d]=(0,n.useState)(!1),c=(0,n.useRef)(null),m=(0,n.useRef)(null);(0,n.useEffect)(()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){let e=window.SpeechRecognition||window.webkitSpeechRecognition;c.current=new e,c.current.continuous=!1,c.current.interimResults=!1,c.current.lang="zh-CN",c.current.onresult=e=>{let t=e.results[0][0].transcript;l(t),x(t)},c.current.onend=()=>{d(!1)},c.current.onerror=e=>{console.error("Speech recognition error",e.error),d(!1)}}},[]),(0,n.useEffect)(()=>{m.current?.scrollIntoView({behavior:"smooth"})},[r]);let x=e=>{e.trim()&&(t(e),l(""))};return(0,i.jsxs)("div",{className:"flex flex-col h-full bg-white md:border-l border-gray-200 shadow-xl w-full",children:[(0,i.jsxs)("div",{className:"p-4 bg-indigo-600 text-white flex items-center justify-between shadow-sm flex-none",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx(L,{className:"w-6 h-6"}),i.jsx("h2",{className:"font-semibold text-lg",children:"AI 助手"})]}),s&&i.jsx("button",{onClick:s,className:"md:hidden text-white/80 hover:text-white p-1",children:i.jsx(R,{className:"w-6 h-6"})})]}),(0,i.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[0===r.length&&(0,i.jsxs)("div",{className:"text-center text-gray-400 mt-10",children:[i.jsx("p",{className:"mb-2",children:"\uD83D\uDC4B 你好! 我是你的智能日程助手。"}),(0,i.jsxs)("p",{className:"text-sm",children:["试着说: ",i.jsx("br",{}),'"明天下午两点和团队开会"']})]}),r.map(e=>i.jsx("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[85%] p-3 rounded-2xl text-sm ${"user"===e.role?"bg-indigo-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none shadow-sm"}`,children:e.content})},e.id)),e&&i.jsx("div",{className:"flex justify-start",children:(0,i.jsxs)("div",{className:"bg-white p-3 rounded-2xl rounded-bl-none border border-gray-200 shadow-sm flex items-center gap-2",children:[i.jsx(I,{className:"w-4 h-4 animate-spin text-indigo-600"}),i.jsx("span",{className:"text-sm text-gray-500",children:"思考中..."})]})}),i.jsx("div",{ref:m})]}),i.jsx("div",{className:"p-4 bg-white border-t border-gray-200 flex-none pb-safe",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>{o?c.current?.stop():(d(!0),c.current?.start())},className:`p-3 rounded-full transition-colors flex-shrink-0 ${o?"bg-red-100 text-red-600 animate-pulse":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,title:"语音输入 (中文)",children:o?i.jsx(T,{className:"w-5 h-5"}):i.jsx(H,{className:"w-5 h-5"})}),i.jsx("div",{className:"flex-1 relative",children:i.jsx("input",{type:"text",value:a,onChange:e=>l(e.target.value),onKeyDown:e=>"Enter"===e.key&&x(a),placeholder:"输入...",className:"w-full pl-4 pr-10 py-3 bg-gray-100 border-none rounded-full text-sm focus:ring-2 focus:ring-indigo-500 outline-none",disabled:e||o})}),i.jsx("button",{onClick:()=>x(a),disabled:!a.trim()||e,className:"p-3 bg-indigo-600 text-white rounded-full hover:bg-indigo-700 disabled:opacity-50 transition-colors flex-shrink-0",children:i.jsx(O,{className:"w-5 h-5"})})]})})]})},W=e=>{},q=()=>{try{return[]}catch(e){return console.error("Failed to load events",e),[]}},G=async(e,t,r)=>{try{let s=await fetch("/api/ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:e,currentEvents:t,viewDate:new Date(r.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})).toISOString()})});if(!s.ok)throw Error("Failed to fetch AI response");return await s.json()}catch(e){throw console.error("Error processing request:",e),e}},U=f("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),Z=f("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),F=()=>{let[e,t]=(0,n.useState)([]),[r,s]=(0,n.useState)(new Date),[l,o]=(0,n.useState)("month"),[d,c]=(0,n.useState)([]),[m,x]=(0,n.useState)(!1),[h,g]=(0,n.useState)(null),[p,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t(q().map(e=>({...e,reminderEnabled:void 0===e.reminderEnabled||e.reminderEnabled,reminderMinutes:void 0!==e.reminderMinutes?e.reminderMinutes:15,priority:void 0!==e.priority?e.priority:a.MEDIUM}))),"Notification"in window&&"granted"!==Notification.permission&&Notification.requestPermission()},[]),(0,n.useEffect)(()=>{W(e)},[e]),(0,n.useEffect)(()=>{let e=setInterval(()=>{let e=new Date;t(t=>t.map(t=>{if(!t.reminderEnabled||t.notified)return t;let r=new Date(t.start).getTime(),s=6e4*t.reminderMinutes,a=r-e.getTime();return a>0&&a<=s?("granted"===Notification.permission&&new Notification(`日程提醒: ${t.title}`,{body:`将在 ${Math.round(a/6e4)} 分钟后开始。`,icon:"/favicon.ico"}),{...t,notified:!0}):t}))},1e4);return()=>clearInterval(e)},[]);let b=async s=>{let a={id:Date.now().toString(),role:"user",content:s,timestamp:Date.now()};c(e=>[...e,a]),x(!0);try{let{events:a,message:i}=await G(s,e,r),n=a.map(e=>({...e,id:crypto.randomUUID(),isCompleted:!1,notified:!1,reminderEnabled:!0,reminderMinutes:15}));n.length>0&&t(e=>[...e,...n]);let l={id:(Date.now()+1).toString(),role:"assistant",content:i,timestamp:Date.now()};c(e=>[...e,l])}catch(t){console.error(t);let e={id:(Date.now()+1).toString(),role:"assistant",content:"处理请求时出错，请检查网络或 API 配置。",timestamp:Date.now()};c(t=>[...t,e])}finally{x(!1)}},f=e=>{t(t=>t.filter(t=>t.id!==e)),g(null)},v=e=>{t(t=>t.map(t=>t.id===e?{...t,isCompleted:!t.isCompleted}:t)),h&&h.id===e&&g(e=>e?{...e,isCompleted:!e.isCompleted}:null)},N=e=>{t(t=>t.map(t=>t.id===e?{...t,reminderEnabled:!t.reminderEnabled}:t)),h&&h.id===e&&g(e=>e?{...e,reminderEnabled:!e.reminderEnabled}:null)},k=(e,r)=>{t(t=>t.map(t=>t.id===e?{...t,reminderMinutes:r,reminderEnabled:!0,notified:!1}:t)),h&&h.id===e&&g(e=>e?{...e,reminderMinutes:r,reminderEnabled:!0,notified:!1}:null)};return(0,i.jsxs)("div",{className:"relative h-screen w-full bg-gray-100 flex overflow-hidden",children:[(0,i.jsxs)("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative z-0",children:[i.jsx("header",{className:"px-4 py-3 md:p-4 bg-white border-b border-gray-200 flex justify-between items-center shadow-sm flex-none z-10",children:i.jsx("div",{children:(0,i.jsxs)("h1",{className:"text-xl md:text-2xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx("span",{className:"bg-indigo-600 text-white px-2 py-0.5 rounded-lg text-lg",children:"LS"}),"LifeStream"]})})}),i.jsx("div",{className:"flex-1 overflow-hidden p-2 md:p-4",children:i.jsx(z,{currentDate:r,viewMode:l,onViewModeChange:o,events:e,onMonthChange:s,onEventClick:g,onToggleComplete:v,onToggleReminder:N})}),i.jsx("button",{onClick:()=>u(!0),className:"md:hidden absolute bottom-6 right-6 w-14 h-14 bg-indigo-600 text-white rounded-full shadow-xl flex items-center justify-center hover:bg-indigo-700 transition-transform active:scale-95 z-30","aria-label":"Open AI Assistant",children:i.jsx(U,{className:"w-7 h-7"})})]}),i.jsx("div",{className:`
        fixed inset-0 z-40 bg-black/20 backdrop-blur-sm md:static md:bg-transparent md:backdrop-blur-none md:z-auto md:w-96 md:flex-none
        transition-all duration-300
        ${p?"opacity-100 visible":"opacity-0 invisible md:opacity-100 md:visible"}
      `,onClick:()=>u(!1),children:i.jsx("div",{className:`
            absolute bottom-0 left-0 right-0 h-[80vh] md:h-full md:relative bg-white shadow-2xl rounded-t-2xl md:rounded-none flex flex-col
            transform transition-transform duration-300 ease-out
            ${p?"translate-y-0":"translate-y-full md:translate-y-0"}
          `,onClick:e=>e.stopPropagation(),children:i.jsx(_,{isProcessing:m,onSendMessage:b,messages:d,onClose:()=>u(!1)})})}),h&&i.jsx("div",{className:"absolute inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-in fade-in duration-200",children:(0,i.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6 relative animate-in zoom-in-95 duration-200",children:[i.jsx("button",{onClick:()=>g(null),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 p-2",children:i.jsx(R,{className:"w-6 h-6"})}),(0,i.jsxs)("div",{className:"flex items-start gap-3 mb-2 pr-8",children:[i.jsx("button",{onClick:()=>v(h.id),className:`p-1 mt-1 rounded-full transition-colors flex-shrink-0 ${h.isCompleted?"text-indigo-600 bg-indigo-50":"text-gray-300 hover:text-gray-500"}`,children:i.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center ${h.isCompleted?"border-indigo-600":"border-current"}`,children:h.isCompleted&&i.jsx("div",{className:"w-3 h-3 bg-indigo-600 rounded-full"})})}),(0,i.jsxs)("div",{children:[i.jsx("h2",{className:`text-xl font-bold leading-tight ${h.isCompleted?"line-through text-gray-400":"text-gray-900"}`,children:h.title}),(0,i.jsxs)("div",{className:"flex gap-2 mt-2 flex-wrap",children:[i.jsx("span",{className:"inline-block px-2 py-0.5 bg-gray-100 rounded text-xs text-gray-600 font-medium",children:h.type}),(0,i.jsxs)("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium ${h.priority===a.HIGH?"bg-red-100 text-red-700":h.priority===a.LOW?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-600"}`,children:[h.priority===a.HIGH&&i.jsx(y,{className:"w-3 h-3"}),h.priority===a.LOW&&i.jsx(w,{className:"w-3 h-3"}),h.priority===a.MEDIUM&&i.jsx(Z,{className:"w-3 h-3"}),h.priority===a.HIGH?"高":h.priority===a.LOW?"低":"中"]})]})]})]}),(0,i.jsxs)("div",{className:"space-y-4 mt-6",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1 p-3 bg-gray-50 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 uppercase font-semibold",children:[i.jsx(C,{className:"w-3 h-3"}),i.jsx("span",{children:"时间"})]}),(0,i.jsxs)("div",{className:"text-gray-800 text-sm",children:[new Date(h.start).toLocaleString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"}),i.jsx("span",{className:"mx-2 text-gray-400",children:"至"}),new Date(h.end).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"})]})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-2 p-3 bg-gray-50 rounded-lg",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[i.jsx(j,{className:`w-4 h-4 ${h.reminderEnabled?"text-indigo-600":"text-gray-400"}`}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"提醒"})]}),i.jsx("button",{onClick:()=>N(h.id),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 ${h.reminderEnabled?"bg-indigo-600":"bg-gray-200"}`,children:i.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${h.reminderEnabled?"translate-x-6":"translate-x-1"}`})})]}),h.reminderEnabled&&i.jsx("div",{className:"mt-2 pl-6",children:i.jsx("select",{value:h.reminderMinutes,onChange:e=>k(h.id,Number(e.target.value)),className:"w-full bg-white border border-gray-200 text-gray-700 text-sm rounded-md p-2 focus:ring-2 focus:ring-indigo-500 outline-none",children:[{value:0,label:"事件开始时"},{value:5,label:"提前 5 分钟"},{value:15,label:"提前 15 分钟"},{value:30,label:"提前 30 分钟"},{value:60,label:"提前 1 小时"},{value:120,label:"提前 2 小时"},{value:1440,label:"提前 1 天"}].map(e=>i.jsx("option",{value:e.value,children:e.label},e.value))})})]}),h.description&&(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[i.jsx("span",{className:"text-xs text-gray-500 uppercase font-semibold",children:"详情"}),i.jsx("p",{className:"text-gray-700 text-sm leading-relaxed bg-white border border-gray-100 p-3 rounded-lg max-h-32 overflow-y-auto",children:h.description})]}),(0,i.jsxs)("div",{className:"pt-4 flex justify-end gap-3 border-t border-gray-100 mt-2",children:[i.jsx("button",{onClick:()=>f(h.id),className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm font-medium",children:"删除"}),i.jsx("button",{onClick:()=>g(null),className:"px-4 py-2 bg-indigo-600 text-white hover:bg-indigo-700 rounded-lg transition-colors text-sm font-medium",children:"关闭"})]})]})]})})]})}},1506:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l,metadata:()=>n});var s=r(9510),a=r(7366),i=r.n(a);r(7272);let n={title:"LifeStream Smart Calendar",description:"AI-powered smart calendar application",themeColor:"#3b82f6",appleWebApp:{capable:!0,statusBarStyle:"black-translucent",title:"LifeStream",startupImage:"/icon-512x512.png"},icons:{icon:"/icon-192x192.png",apple:"/icon-180x180.png"},manifest:"/manifest.json"};function l({children:e}){return(0,s.jsxs)("html",{lang:"zh-CN",children:[s.jsx("head",{children:s.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"})}),(0,s.jsxs)("body",{className:i().className,children:[s.jsx("script",{dangerouslySetInnerHTML:{__html:`
              if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                  navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                      console.log('Service Worker registered with scope:', registration.scope);
                    })
                    .catch(error => {
                      console.error('Service Worker registration failed:', error);
                    });
                });
              }
            `}}),e]})]})}},5807:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(9510);r(1159);let a=(0,r(8570).createProxy)(String.raw`C:\AIRL\lifestream-智能日历 （CN）\components\App.tsx#default`);function i(){return s.jsx(a,{})}},7272:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,82],()=>r(6142));module.exports=s})();